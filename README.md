# 介绍

一款聊天软件，客户端使用Qt开发GUI，服务端使用go语言。

# 功能

1、基础功能

用户注册、登录、聊天（暂不考虑群聊功能）。

好友：添加好友、删除好友、查找好友。

消息：未读消息

2、高级功能设想

验证码（邮箱，为什么不考虑短信？因为短信要花钱哈哈哈）。

# 初步构架设想

+ 1、通信

    基于Zinx框架[https://github.com/aceld/zinx][Zinx框架]，并对框架进行了一些美化，来符合气质，气质不能输。

    1）通信协议
    初步想法为使用protobuf协议，以应对高速传输。（不知道能不能弥补RSA加密解密速度慢的问题）

    报头+包体，使用框架内的协议进行通信

    报头：包含数据长度，请求服务的类型id，共8个字节。

    包体：数据自身（已加密）

    2）数据安全

    采用双向的RSA加密方式，客户端与服务端各持有不同的私钥，和对方私钥所对应的公钥。通信前将数据使用公钥加密，接收数据后再使用私钥解密。

    3）连接合法性验证

    在建立连接（客户请求登录），需完成猜谜，解决一段密码。生成token。具体策略还在研究。防止非法socket连接。

+ 2、数据库

    使用MySQL + Redis数据库（初步构想，关于数据库的构架还有待细研究）。可能会加入MongoDB。

    对于用户注册产生的号码（类似QQ号），还在构想解决方案，初步想法是一批一批建好号码，比如先生成10000个，用完了再生成10000个。

    完成好数据库的优化。

+ 3、语言

    客户端使用Qt5来编写GUI，服务端使用go语言，因为go语言操作数据库比较方便，体量小，高并发多线程处理比较强悍。如果有可能，会考虑Qt6。

# 使用
## 服务端
### 依赖： 

go语言环境，protobuf环境（protoc和go的插件），mysql，redis，openssl。

用到的第三方库：Zinx框架，color库，其具体已写在go.mod文件中。
### 说明：
zinx框架内有很多不必要的fmt.Println语句用于控制台输出，建议根据需求自行修改框架源码。

服务端源代码集成了日志模块，而不使用zinx框架内的日志模块，可实现彩色输出。

测试框架使用goconvey，在test目录内运行 go test，可进行RSA加密解密测试，生成的公钥私钥可直接使用。

在使用之前，请使用openssl生成PKSC#8的公钥与私钥，文件名称要与zinx.json中定义的名称相同，秘钥长度推荐为2048字节。密钥位置与zinx.json中的位置相同。

```shell
openssl genrsa -out private.pem 2048 # 私钥
openssl rsa -in private.pem -pubout -out public.pem # 根据私钥生成公钥
```

[Zinx框架]: https://github.com/aceld/zinx